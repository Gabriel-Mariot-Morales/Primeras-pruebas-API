{
	"info": {
		"_postman_id": "c2c2c2c2-5678-5678-5678-1234567890cd",
		"name": "Tierra Media API (Dinámica y Completa)",
		"description": "Colección adaptada para usar variables dinámicas. Ejecutar en orden secuencial para que las dependencias (IDs) funcionen correctamente.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"variable": [
		{ "key": "base_url", "value": "http://localhost/api", "type": "string" },
		{ "key": "region_id", "value": "", "type": "string" },
		{ "key": "realm_id", "value": "", "type": "string" },
		{ "key": "hero_id", "value": "", "type": "string" },
		{ "key": "creature_id", "value": "", "type": "string" },
		{ "key": "artifact_id", "value": "", "type": "string" }
	],
	"item": [
		{
			"name": "1. Regiones",
			"item": [
				{
					"name": "Crear Región (Valinor)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200 or 201\", function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
									"});",
									"var jsonData = pm.response.json();",
									"pm.collectionVariables.set(\"region_id\", jsonData.id);",
									"console.log(\"Region ID guardado: \" + jsonData.id);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Valinor\"\n}",
							"options": { "raw": { "language": "json" } }
						},
						"url": "{{base_url}}/regions"
					}
				},
				{
					"name": "Listar Regiones",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/regions" }
				},
				{
					"name": "Ver Región Creada",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/regions/{{region_id}}" }
				},
				{
					"name": "Actualizar Región",
					"request": {
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Valinor (Tierras Imperecederas)\"\n}",
							"options": { "raw": { "language": "json" } }
						},
						"url": "{{base_url}}/regions/{{region_id}}"
					}
				}
			]
		},
		{
			"name": "2. Reinos",
			"item": [
				{
					"name": "Crear Reino (Isengard)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200 or 201\", function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
									"});",
									"var jsonData = pm.response.json();",
									"pm.collectionVariables.set(\"realm_id\", jsonData.id);",
									"console.log(\"Realm ID guardado: \" + jsonData.id);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Isengard\",\n    \"ruler\": \"Saruman\",\n    \"alignment\": \"Mal\",\n    \"region_id\": {{region_id}}\n}",
							"options": { "raw": { "language": "json" } }
						},
						"url": "{{base_url}}/realms"
					}
				},
				{
					"name": "Listar Reinos",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/realms" }
				},
				{
					"name": "Ver Reino Creado",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/realms/{{realm_id}}" }
				},
				{
					"name": "Actualizar Reino",
					"request": {
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"alignment\": \"Neutral\"\n}",
							"options": { "raw": { "language": "json" } }
						},
						"url": "{{base_url}}/realms/{{realm_id}}"
					}
				}
			]
		},
		{
			"name": "3. Héroes",
			"item": [
				{
					"name": "Crear Héroe (Boromir)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200 or 201\", function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
									"});",
									"var jsonData = pm.response.json();",
									"pm.collectionVariables.set(\"hero_id\", jsonData.id);",
									"console.log(\"Hero ID guardado: \" + jsonData.id);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Boromir\",\n    \"race\": \"Humano\",\n    \"rank\": \"Capitán\",\n    \"realm_id\": {{realm_id}},\n    \"alive\": false\n}",
							"options": { "raw": { "language": "json" } }
						},
						"url": "{{base_url}}/heroes"
					}
				},
				{
					"name": "Listar Héroes",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/heroes" }
				},
				{
					"name": "Ver Héroe Creado",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/heroes/{{hero_id}}" }
				},
				{
					"name": "Actualizar Héroe",
					"request": {
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"alive\": true\n}",
							"options": { "raw": { "language": "json" } }
						},
						"url": "{{base_url}}/heroes/{{hero_id}}"
					}
				}
			]
		},
		{
			"name": "4. Criaturas",
			"item": [
				{
					"name": "Crear Criatura (Ella-Laraña)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200 or 201\", function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
									"});",
									"var jsonData = pm.response.json();",
									"pm.collectionVariables.set(\"creature_id\", jsonData.id);",
									"console.log(\"Creature ID guardado: \" + jsonData.id);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Ella-Laraña\",\n    \"species\": \"Araña Gigante\",\n    \"threat_level\": 8,\n    \"region_id\": {{region_id}}\n}",
							"options": { "raw": { "language": "json" } }
						},
						"url": "{{base_url}}/creatures"
					}
				},
				{
					"name": "Listar Criaturas",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/creatures" }
				},
				{
					"name": "Ver Criatura Creada",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/creatures/{{creature_id}}" }
				},
				{
					"name": "Actualizar Criatura",
					"request": {
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"threat_level\": 10\n}",
							"options": { "raw": { "language": "json" } }
						},
						"url": "{{base_url}}/creatures/{{creature_id}}"
					}
				}
			]
		},
		{
			"name": "5. Artefactos",
			"item": [
				{
					"name": "Crear Artefacto (Dardo - Con Array Héroes)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200 or 201\", function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
									"});",
									"var jsonData = pm.response.json();",
									"pm.collectionVariables.set(\"artifact_id\", jsonData.id);",
									"console.log(\"Artifact ID guardado: \" + jsonData.id);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Dardo\",\n    \"type\": \"Espada\",\n    \"origin_realm_id\": {{realm_id}},\n    \"power_level\": 95,\n    \"description\": \"Brilla cuando hay orcos cerca\",\n    \"hero_ids\": [{{hero_id}}]\n}",
							"options": { "raw": { "language": "json" } }
						},
						"url": "{{base_url}}/artifacts"
					}
				},
				{
					"name": "Listar Artefactos",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/artifacts" }
				},
				{
					"name": "Ver Artefacto Creado",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/artifacts/{{artifact_id}}" }
				},
				{
					"name": "Actualizar Artefacto",
					"request": {
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"power_level\": 100\n}",
							"options": { "raw": { "language": "json" } }
						},
						"url": "{{base_url}}/artifacts/{{artifact_id}}"
					}
				}
			]
		},
		{
			"name": "6. Opcionales",
			"item": [
				{
					"name": "Asignar Artefacto a Héroe (Endpoint extra)",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"hero_id\": {{hero_id}},\n    \"artifact_id\": {{artifact_id}}\n}",
							"options": { "raw": { "language": "json" } }
						},
						"url": "{{base_url}}/artifact-hero"
					}
				},
				{
					"name": "Quitar Artefacto de Héroe",
					"request": {
						"method": "DELETE",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"hero_id\": {{hero_id}},\n    \"artifact_id\": {{artifact_id}}\n}",
							"options": { "raw": { "language": "json" } }
						},
						"url": "{{base_url}}/artifact-hero"
					}
				},
				{
					"name": "Listar Artefactos de un Héroe",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/heroes/{{hero_id}}/artifacts" }
				},
				{
					"name": "Listar Dueños de un Artefacto",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/artifacts/{{artifact_id}}/heroes" }
				},
				{
					"name": "Héroes de un Reino",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/realms/{{realm_id}}/heroes" }
				},
				{
					"name": "Criaturas de una Región",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/regions/{{region_id}}/creatures" }
				},
				{
					"name": "Héroes Vivos",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/heroes/alive" }
				},
				{
					"name": "Artefactos Top (>90)",
					"request": { "method": "GET", "header": [], "url": "{{base_url}}/artifacts/top" }
				}
			]
		},
		{
			"name": "7. Limpieza (Borrado en orden)",
			"item": [
				{
					"name": "Borrar Artefacto",
					"request": { "method": "DELETE", "header": [], "url": "{{base_url}}/artifacts/{{artifact_id}}" }
				},
				{
					"name": "Borrar Criatura",
					"request": { "method": "DELETE", "header": [], "url": "{{base_url}}/creatures/{{creature_id}}" }
				},
				{
					"name": "Borrar Héroe",
					"request": { "method": "DELETE", "header": [], "url": "{{base_url}}/heroes/{{hero_id}}" }
				},
				{
					"name": "Borrar Reino",
					"request": { "method": "DELETE", "header": [], "url": "{{base_url}}/realms/{{realm_id}}" }
				},
				{
					"name": "Borrar Región",
					"request": { "method": "DELETE", "header": [], "url": "{{base_url}}/regions/{{region_id}}" }
				}
			]
		}
	]
}
